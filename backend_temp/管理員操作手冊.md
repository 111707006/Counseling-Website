# 張老師台北心理諮商所 - 管理員操作手冊

## 📋 目錄
1. [系統簡介](#系統簡介)
2. [管理員登入](#管理員登入)
3. [權限管理](#權限管理)
4. [預約管理](#預約管理)
5. [心理師管理](#心理師管理)
6. [測驗管理](#測驗管理)
7. [文章管理](#文章管理)
8. [系統維護](#系統維護)
9. [常見問題](#常見問題)

---

## 🎯 系統簡介

本管理系統是基於 Django Admin 開發的心理諮商機構管理平台，提供完整的預約管理、心理師管理、測驗管理等功能。

### 核心功能模組
- **預約管理**：處理來談者預約申請、心理師分配、時段確認
- **心理師管理**：維護心理師資料、專業領域、收費設定
- **測驗管理**：管理 WHO-5、BSRS-5 心理測驗與結果
- **文章管理**：維護心理健康相關文章內容
- **用戶管理**：管理系統用戶與權限

---

## 🔐 管理員登入

### 登入步驟
1. 開啟瀏覽器，前往 `http://127.0.0.1:8000/admin/`
2. 輸入管理員帳號密碼：
   - **帳號**：`admin@mindcare.com`
   - **密碼**：`admin123456`
3. 點選「登入」進入管理後台

### 建立新管理員
```bash
# 在後端目錄執行以下指令
python manage.py create_admin --email 新管理員@email.com --password 密碼
```

---

## 👥 權限管理

### 權限分級
- **超級管理員** (Superuser)：完整系統管理權限
- **員工** (Staff)：Django Admin 登入權限，可管理指定模組
- **心理師**：可查看自己負責的預約（需綁定用戶帳號）

### 權限設定
1. 進入「用戶」→「用戶」頁面
2. 選擇要設定的用戶
3. 勾選相應權限：
   - `職員狀態`：允許登入管理介面
   - `超級用戶狀態`：完整管理權限
   - `用戶權限`：細項功能權限

---

## 📅 預約管理

### 預約列表概覽
進入「預約」→「預約」可查看所有預約申請，包含：
- 用戶資訊（姓名、Email）
- 心理師分配狀態
- 預約狀態（待確認/已確認/已完成/已取消）
- 諮商方式（線上/實體）
- 建立時間與確認時間

### 預約處理流程

#### 1. 新預約通知
- 系統會自動發送郵件通知管理員有新預約
- 在預約列表中，新預約顯示為「待確認」狀態（橙色）

#### 2. 分配心理師
**適用情況**：預約未指定心理師時

**操作步驟**：
1. 點選預約記錄進入詳細頁面
2. 點選「分配心理師」按鈕
3. 系統會自動推薦符合專業需求的心理師
4. 從下拉選單選擇合適的心理師
5. 點選「分配心理師」完成

**系統會自動**：
- 根據來談者需求推薦專業匹配的心理師
- 更新預約的收費金額

#### 3. 確認預約時間
**前提條件**：必須已分配心理師

**操作步驟**：
1. 在預約詳細頁面點選「確認時間」
2. 查看來談者的偏好時段表格
3. 點選「選擇此時段」快速填入建議時間，或手動輸入具體時間
4. 點選「確認時間」完成

**系統會自動**：
- 創建對應的可用時段記錄
- 檢查時段衝突
- 更新預約狀態為「已確認」
- 發送確認通知郵件給來談者

#### 4. 預約狀態管理
**操作步驟**：
1. 點選「管理狀態」按鈕
2. 選擇新的狀態：
   - **已確認**：預約時間已確定
   - **已完成**：諮商已結束
   - **已拒絕**：無法安排預約
   - **已取消**：取消預約
3. 如選擇「已拒絕」，需填寫拒絕原因
4. 點選「更新狀態」完成

**系統會自動**：
- 發送狀態變更通知郵件
- 如為拒絕/取消，釋放已佔用的時段

### 預約查詢功能
- **搜尋**：可依用戶Email、姓名、電話、心理師姓名搜尋
- **篩選**：可依狀態、諮商方式、心理師、建立時間篩選
- **排序**：預設依建立時間倒序排列

---

## 👨‍⚕️ 心理師管理

### 心理師基本資料
進入「心理師」→「心理師檔案」可管理心理師資訊：

#### 基本資料設定
- **姓名**：心理師全名
- **職稱**：如「諮商心理師」、「臨床心理師」
- **證照字號**：專業證照編號
- **學歷**：教育背景
- **經歷**：工作經驗描述
- **諮商理念**：個人治療理念
- **照片**：可上傳個人照片

#### 專業領域設定
1. **新關聯式專業領域**：
   - 點選「專業領域」欄位
   - 從分類清單中選擇適用的專業領域
   - 可多選，系統會自動分類顯示

2. **舊文字描述**（過渡期保留）：
   - 可直接輸入專長文字描述

#### 服務設定
1. **諮詢模式設定**：
   ```json
   ["online", "offline"]  // 線上+實體
   ["online"]             // 僅線上
   ["offline"]            // 僅實體
   ```

2. **收費設定**：
   ```json
   {
     "online": 1200,      // 線上諮商每次 1200 元
     "offline": 1500      // 實體諮商每次 1500 元
   }
   ```

#### 可用時段設定
在心理師編輯頁面下方可設定每週固定可用時段：
- 選擇星期幾
- 設定開始與結束時間
- 可設定多個時段

### 專業領域分類管理
進入「心理師」→「專業領域分類」可管理專業分類系統：

#### 分類架構
- **理論取向**：認知行為治療、心理動力取向等
- **議題專精**：焦慮症治療、創傷治療等
- **服務族群**：兒童、青少年、成人等
- **治療方式**：個別諮商、團體治療等

#### 新增專業領域
1. 進入「心理師」→「專業領域」
2. 點選「新增專業領域」
3. 填寫領域名稱、選擇所屬分類
4. 撰寫描述內容
5. 設定是否啟用

---

## 📊 測驗管理

### 測驗系統概覽
系統內建兩套標準心理測驗：
- **WHO-5**：世界衛生組織五項身心健康指標
- **BSRS-5**：五項精神量表

### 測驗結果管理
進入「測驗」→「回應」可查看所有測驗結果：

#### 結果分析
- **總分**：自動計算的測驗總分
- **風險等級**：系統自動判定的風險程度
  - WHO-5：良好 / 中度關注 / 需要關注
  - BSRS-5：正常 / 輕度 / 中度 / 重度
- **答題詳情**：可查看每題的選擇與得分

#### 高風險個案追蹤
- 系統會特別標示高風險測驗結果
- 可結合預約系統，優先安排高風險個案
- 建議建立追蹤機制

### 測驗題目維護
**注意**：測驗題目為標準化量表，一般不建議修改

如需維護測驗內容：
1. 進入「測驗」→「測驗」
2. 選擇要維護的測驗（WHO5 或 BSRS5）
3. 可查看或編輯題目與選項設定

---

## 📰 文章管理

### 文章發布流程
進入「文章」→「文章」管理心理健康相關文章：

#### 新增文章
1. 點選「新增文章」
2. 填寫文章資訊：
   - **標題**：文章標題（200字內）
   - **內容**：文章正文，支援多行文字
   - **標籤**：JSON格式標籤，例如：`["焦慮", "壓力管理", "放鬆技巧"]`
   - **作者**：選擇文章作者
3. 點選「儲存」完成發布

#### 文章標籤系統
標籤採用 JSON 陣列格式，常用標籤分類：
- **情緒議題**：焦慮、憂鬱、壓力、情緒管理
- **關係議題**：人際關係、親子關係、伴侶關係
- **生活議題**：職場壓力、學習困擾、生涯規劃
- **治療方法**：認知行為治療、正念療法、放鬆技巧

#### 文章搜尋與管理
- **搜尋**：可依標題、標籤內容搜尋
- **排序**：預設依發布時間倒序排列
- **編輯**：可隨時修改文章內容與標籤

---

## 🔧 系統維護

### 日常維護作業

#### 1. 資料備份
```bash
# 備份資料庫（建議每日執行）
python manage.py dumpdata > backup_$(date +%Y%m%d).json

# 備份指定模組
python manage.py dumpdata appointments > appointments_backup.json
```

#### 2. 日誌檢查
定期檢查系統日誌檔案：
- `server.log`：伺服器運行日誌
- `admin_server.log`：管理員操作日誌

#### 3. 郵件系統測試
測試郵件通知功能是否正常：
```bash
python manage.py shell
>>> from django.core.mail import send_mail
>>> send_mail('測試', '測試郵件', 'noreply@mindcare.com', ['test@example.com'])
```

### 效能監控

#### 預約統計
在預約管理頁面可查看：
- 總預約數
- 待確認預約數
- 已確認預約數
- 當日新預約數

#### 資料庫維護
```bash
# 清理過期 sessions
python manage.py clearsessions

# 檢查資料庫一致性
python manage.py check --database default
```

---

## ❓ 常見問題

### Q1：忘記管理員密碼怎麼辦？
**解決方案**：
```bash
python manage.py changepassword admin@mindcare.com
```
或重新創建管理員帳號。

### Q2：郵件通知無法發送
**可能原因**：
- 郵件伺服器設定問題
- 網路連線問題
- 收件人信箱問題

**檢查步驟**：
1. 確認 `settings.py` 中的郵件設定
2. 測試郵件伺服器連線
3. 檢查收件人信箱是否正確

### Q3：預約時段衝突
**處理方式**：
1. 系統會自動檢測衝突並提示
2. 選擇其他可用時段
3. 或聯繫心理師調整時間

### Q4：心理師無法登入後台
**解決步驟**：
1. 確認心理師已建立用戶帳號
2. 在心理師檔案中綁定用戶帳號
3. 設定適當的登入權限

### Q5：測驗結果顯示異常
**檢查項目**：
1. 確認所有題目都有作答
2. 檢查計分邏輯是否正確
3. 查看測驗設定是否完整

### Q6：靜態檔案無法載入
**解決方案**：
```bash
python manage.py collectstatic --noinput
```

### Q7：如何查看系統使用統計？
目前可在各模組的管理頁面查看基本統計，如需詳細分析可考慮加裝 Django Admin 統計套件。

---

## 📞 技術支援

### 系統資訊
- **Django 版本**：5.1.7
- **Python 版本**：3.10+
- **資料庫**：MySQL
- **管理介面**：Django Admin

### 聯絡資訊
如遇技術問題，請聯繫系統開發團隊並提供：
1. 錯誤訊息截圖
2. 操作步驟描述
3. 系統日誌內容

---

## 📝 版本更新記錄

### v1.0.0 (2024-07-25)
- ✅ 完整預約管理流程
- ✅ 心理師專業領域關聯式管理
- ✅ WHO-5 與 BSRS-5 測驗系統
- ✅ 郵件通知機制
- ✅ 自定義管理介面

---

*本手冊最後更新時間：2024年7月25日*