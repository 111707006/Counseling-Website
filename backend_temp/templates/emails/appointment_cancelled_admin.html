{% extends "emails/base_email.html" %}

{% block title %}é ç´„å–æ¶ˆé€šçŸ¥ - å¿ƒç†è«®å•†é ç´„ç³»çµ±{% endblock %}

{% block header_title %}ğŸš« é ç´„å–æ¶ˆé€šçŸ¥{% endblock %}
{% block header_subtitle %}<p style="margin: 10px 0 0 0; font-size: 16px; opacity: 0.9;">æœ‰ç”¨æˆ¶å–æ¶ˆäº†é ç´„ç”³è«‹</p>{% endblock %}

{% block greeting %}
<p>è¦ªæ„›çš„ç®¡ç†å“¡ï¼Œæ‚¨å¥½ï¼š</p>
{% endblock %}

{% block content %}
<div class="alert warning">
    <strong>âš ï¸ é ç´„å–æ¶ˆé€šçŸ¥</strong><br>
    ç”¨æˆ¶å·²ä¸»å‹•å–æ¶ˆé ç´„ç”³è«‹ï¼Œç›¸é—œæ™‚æ®µç¾å·²é‡‹æ”¾å¯ä¾›å…¶ä»–ç”¨æˆ¶é ç´„ã€‚
</div>

<p>ä»¥ä¸‹æ˜¯å–æ¶ˆçš„é ç´„è©³ç´°è³‡è¨Šï¼š</p>
{% endblock %}

{% block appointment_details %}
<div class="appointment-card" style="border-left: 4px solid #f56565;">
    <h3 style="margin-top: 0; color: #e53e3e;">âŒ å·²å–æ¶ˆçš„é ç´„</h3>
    
    <div class="appointment-detail">
        <span class="detail-label">é ç´„ç·¨è™Ÿï¼š</span>
        <span class="detail-value"><strong style="color: #e53e3e;">#{{ appointment.id }}</strong></span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">ç”¨æˆ¶å§“åï¼š</span>
        <span class="detail-value">{{ appointment.detail.name }}</span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">è¯çµ¡é›»è©±ï¼š</span>
        <span class="detail-value">{{ appointment.detail.phone }}</span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">é›»å­éƒµä»¶ï¼š</span>
        <span class="detail-value">{{ appointment.user.email }}</span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">æŒ‡å®šå¿ƒç†å¸«ï¼š</span>
        <span class="detail-value">{{ appointment.therapist.name }}</span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">åŸç”³è«‹æ™‚é–“ï¼š</span>
        <span class="detail-value">{{ appointment.created_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">å–æ¶ˆæ™‚é–“ï¼š</span>
        <span class="detail-value"><strong>{{ appointment.updated_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</strong></span>
    </div>
    
    <div class="appointment-detail">
        <span class="detail-label">åŸç‹€æ…‹ï¼š</span>
        <span class="detail-value">
            {% if appointment.status == 'cancelled' %}
                <span style="background-color: #fed7d7; color: #9b2c2c; padding: 4px 12px; border-radius: 15px; font-size: 12px;">
                    âŒ å·²å–æ¶ˆ
                </span>
            {% endif %}
        </span>
    </div>
</div>

<div class="appointment-card">
    <h3 style="margin-top: 0; color: #667eea;">åŸé ç´„åå¥½æ™‚æ®µ</h3>
    {% for period in appointment.preferred_periods.all %}
    <div class="appointment-detail">
        <span class="detail-label">æ™‚æ®µ {{ forloop.counter }}ï¼š</span>
        <span class="detail-value">
            {{ period.date|date:"Yå¹´mæœˆdæ—¥" }} 
            {% if period.period == 'morning' %}ä¸Šåˆ (09:00-12:00)
            {% elif period.period == 'afternoon' %}ä¸‹åˆ (13:00-17:00)
            {% elif period.period == 'evening' %}æ™šä¸Š (18:00-21:00)
            {% endif %}
            <span style="color: #48bb78; font-weight: bold;">âœ… å·²é‡‹æ”¾</span>
        </span>
    </div>
    {% endfor %}
</div>

{% if appointment.slot %}
<div class="appointment-card" style="border-left: 4px solid #48bb78; background-color: #f0fff4;">
    <h3 style="margin-top: 0; color: #22543d;">ğŸ”„ æ™‚æ®µç‹€æ…‹æ›´æ–°</h3>
    <div class="appointment-detail">
        <span class="detail-label">å·²ç¢ºèªæ™‚æ®µï¼š</span>
        <span class="detail-value">
            {{ appointment.slot.slot_time|date:"Yå¹´mæœˆdæ—¥ H:i" }}
            <span style="background-color: #c6f6d5; color: #22543d; padding: 2px 8px; border-radius: 4px; font-size: 11px; margin-left: 10px;">
                å·²è‡ªå‹•é‡‹æ”¾
            </span>
        </span>
    </div>
    <p style="margin: 10px 0 0 0; padding: 10px; background-color: white; border-radius: 4px; color: #22543d; font-size: 14px;">
        âœ… è©²æ™‚æ®µç¾å·²å¯ä¾›å…¶ä»–ç”¨æˆ¶é ç´„
    </p>
</div>
{% endif %}

{% if appointment.detail.main_concerns %}
<div class="appointment-card">
    <h3 style="margin-top: 0; color: #667eea;">åŸä¸»è¦å›°æ“¾</h3>
    <p style="margin: 0; padding: 10px; background-color: #f8f9fa; border-radius: 4px; border: 1px solid #e2e8f0; color: #666;">
        {{ appointment.detail.main_concerns }}
    </p>
</div>
{% endif %}
{% endblock %}

{% block actions %}
<div style="text-align: center; margin: 30px 0;">
    <p><strong>ğŸ“Š éœ€è¦è™•ç†çš„äº‹é …</strong></p>
    <div style="background-color: #f8f9fa; padding: 20px; border-radius: 8px; margin: 20px 0;">
        <div style="display: flex; gap: 20px; justify-content: space-around; flex-wrap: wrap;">
            <div style="text-align: center;">
                <div style="font-size: 24px; margin-bottom: 5px;">âœ…</div>
                <div style="font-size: 12px; color: #666;">æ™‚æ®µå·²è‡ªå‹•é‡‹æ”¾</div>
            </div>
            <div style="text-align: center;">
                <div style="font-size: 24px; margin-bottom: 5px;">ğŸ“Š</div>
                <div style="font-size: 12px; color: #666;">çµ±è¨ˆå·²è‡ªå‹•æ›´æ–°</div>
            </div>
            <div style="text-align: center;">
                <div style="font-size: 24px; margin-bottom: 5px;">ğŸ“</div>
                <div style="font-size: 12px; color: #666;">è¨˜éŒ„å·²ä¿å­˜</div>
            </div>
        </div>
    </div>
    <a href="{{ admin_url }}" class="button secondary">æŸ¥çœ‹ç®¡ç†å¾Œå°</a>
</div>
{% endblock %}

{% block additional_info %}
<div class="divider"></div>

<div style="display: flex; gap: 20px; margin: 20px 0;">
    <div style="flex: 1; background-color: #ebf8ff; padding: 20px; border-radius: 6px; border: 1px solid #90cdf4;">
        <h4 style="margin-top: 0; color: #2a4365;">ğŸ“ˆ ç³»çµ±è‡ªå‹•è™•ç†</h4>
        <ul style="margin: 10px 0; padding-left: 20px; color: #2a4365; line-height: 1.6;">
            <li>é ç´„ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œå·²å–æ¶ˆã€</li>
            <li>ç›¸é—œæ™‚æ®µå·²é‡‹æ”¾</li>
            <li>çµ±è¨ˆæ•¸æ“šå·²è‡ªå‹•èª¿æ•´</li>
            <li>é€šçŸ¥ç”¨æˆ¶å–æ¶ˆæˆåŠŸ</li>
        </ul>
    </div>
    <div style="flex: 1; background-color: #f0fff4; padding: 20px; border-radius: 6px; border: 1px solid #9ae6b4;">
        <h4 style="margin-top: 0; color: #22543d;">ğŸ’¡ å»ºè­°å‹•ä½œ</h4>
        <ul style="margin: 10px 0; padding-left: 20px; color: #22543d; line-height: 1.6;">
            <li>æª¢æŸ¥æ˜¯å¦æœ‰å€™è£œåå–®</li>
            <li>è©•ä¼°å–æ¶ˆåŸå› ï¼ˆå¦‚é©ç”¨ï¼‰</li>
            <li>æ›´æ–°å¿ƒç†å¸«è¡Œç¨‹</li>
            <li>è¿½è¹¤ç”¨æˆ¶å¾ŒçºŒéœ€æ±‚</li>
        </ul>
    </div>
</div>

<div class="alert info">
    <strong>ğŸ“Š å–æ¶ˆçµ±è¨ˆæ‘˜è¦</strong><br>
    <div style="margin-top: 15px; line-height: 1.6;">
        â€¢ å–æ¶ˆæ™‚é–“ï¼š<strong>{{ appointment.updated_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</strong><br>
        â€¢ åŸç‹€æ…‹ï¼š<strong>{{ appointment.get_status_display }}</strong> â†’ å·²å–æ¶ˆ<br>
        â€¢ è™•ç†æ–¹å¼ï¼š<strong>ç”¨æˆ¶ä¸»å‹•å–æ¶ˆ</strong><br>
        â€¢ å½±éŸ¿ç¯„åœï¼š<strong>æ™‚æ®µå·²é‡‹æ”¾ï¼Œå¯ä¾›é‡æ–°é ç´„</strong>
    </div>
</div>

<div class="alert warning">
    <strong>âš ï¸ æ³¨æ„äº‹é …</strong><br>
    â€¢ å¦‚è©²æ™‚æ®µå·²æœ‰å€™è£œç”¨æˆ¶ï¼Œè«‹ä¸»å‹•è¯ç¹«å®‰æ’<br>
    â€¢ å»ºè­°æª¢æŸ¥å¿ƒç†å¸«ç•¶æ—¥è¡Œç¨‹æ˜¯å¦éœ€è¦èª¿æ•´<br>
    â€¢ å–æ¶ˆè¨˜éŒ„å·²ä¿å­˜ï¼Œå¯ç”¨æ–¼å¾ŒçºŒåˆ†æ<br>
    â€¢ å¦‚ç”¨æˆ¶é »ç¹å–æ¶ˆï¼Œå¯è©•ä¼°æ˜¯å¦éœ€è¦ç‰¹åˆ¥é—œæ³¨
</div>

<div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 25px; border-radius: 8px; margin: 30px 0; text-align: center;">
    <h3 style="margin: 0 0 15px 0;">ğŸ”„ ç³»çµ±é‹ä½œæ­£å¸¸</h3>
    <p style="margin: 0; font-size: 16px; opacity: 0.9;">
        é ç´„å–æ¶ˆå·²å¦¥å–„è™•ç†ï¼Œç›¸é—œè³‡æºå·²é‡‹æ”¾ï¼Œ<br>
        ç³»çµ±æŒçºŒç‚ºå…¶ä»–ç”¨æˆ¶æä¾›å„ªè³ªæœå‹™ã€‚
    </p>
</div>
{% endblock %}

{% block footer %}
<p>ç³»çµ±å·²è‡ªå‹•è™•ç†æ­¤æ¬¡å–æ¶ˆï¼Œç„¡éœ€é¡å¤–æ“ä½œã€‚</p>
<div class="footer-links">
    <a href="{{ admin_url }}">ç®¡ç†å¾Œå°</a>
    <a href="#">é ç´„çµ±è¨ˆ</a>
    <a href="#">ç³»çµ±è¨­å®š</a>
</div>
<p>&copy; 2025 å¿ƒç†è«®å•†é ç´„ç³»çµ±. ä¿ç•™æ‰€æœ‰æ¬Šåˆ©ã€‚</p>
{% endblock %}